{% extends "base.html" %}

{% block title %}Home - Banking AI Assistant{% endblock %}
{% block page_name %}home{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center min-vh-100">
            <div class="col-lg-6">
                <div class="hero-content">
                    <h1 class="display-4 fw-bold text-primary mb-4">
                        🏛️ Banking <span class="text-secondary">AI Assistant</span>
                    </h1>
                    <p class="lead text-muted mb-4">
                        AI-powered banking location finder and currency intelligence for Azerbaijan. 
                        Find the nearest branches, ATMs, and get real-time currency rates.
                    </p>
                    
                    <div class="d-flex flex-wrap gap-3 mb-4">
                        <a href="/locations" class="btn btn-primary btn-lg">
                            <i class="bi bi-geo-alt me-2"></i>Find Locations
                        </a>
                        <a href="/currency" class="btn btn-outline-primary btn-lg">
                            <i class="bi bi-currency-exchange me-2"></i>Currency Rates
                        </a>
                        <a href="/chat" class="btn btn-success btn-lg">
                            <i class="bi bi-chat-dots me-2"></i>AI Chat
                        </a>
                    </div>
                    
                    <div class="quick-stats">
                        <div class="row text-center">
                            <div class="col-4">
                                <div class="stat-item">
                                    <div class="h3 text-primary mb-0">100+</div>
                                    <small class="text-muted">Locations</small>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="stat-item">
                                    <div class="h3 text-primary mb-0">8</div>
                                    <small class="text-muted">Currencies</small>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="stat-item">
                                    <div class="h3 text-primary mb-0">24/7</div>
                                    <small class="text-muted">AI Support</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6">
                <div class="hero-image">
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">🏧</div>
                            <h6>ATMs</h6>
                            <p class="small text-muted">Find nearest ATMs with real-time availability</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🏛️</div>
                            <h6>Branches</h6>
                            <p class="small text-muted">Locate branches with working hours</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">💱</div>
                            <h6>Currency</h6>
                            <p class="small text-muted">Real-time exchange rates from CBAR</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🤖</div>
                            <h6>AI Chat</h6>
                            <p class="small text-muted">Smart assistance for all your banking needs</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Services Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-5">
                <h2 class="fw-bold">Available Services</h2>
                <p class="text-muted">Find all banking services in one place</p>
            </div>
        </div>
        
        <div class="row g-4">
            <div class="col-md-6 col-lg-3">
                <div class="service-card h-100">
                    <div class="service-icon">🏛️</div>
                    <h5>Branches</h5>
                    <p class="text-muted small">Full banking services with customer support</p>
                    <a href="#" onclick="findService('branch')" class="btn btn-outline-primary btn-sm">
                        Find Branches
                    </a>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-3">
                <div class="service-card h-100">
                    <div class="service-icon">🏧</div>
                    <h5>ATMs</h5>
                    <p class="text-muted small">24/7 cash withdrawal and deposits</p>
                    <a href="#" onclick="findService('atm')" class="btn btn-outline-primary btn-sm">
                        Find ATMs
                    </a>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-3">
                <div class="service-card h-100">
                    <div class="service-icon">💰</div>
                    <h5>Cash-In Machines</h5>
                    <p class="text-muted small">Quick cash deposits without visiting branches</p>
                    <a href="#" onclick="findService('cash_in')" class="btn btn-outline-primary btn-sm">
                        Find Cash-In
                    </a>
                </div>
            </div>
            
            <div class="col-md-6 col-lg-3">
                <div class="service-card h-100">
                    <div class="service-icon">💻</div>
                    <h5>Digital Centers</h5>
                    <p class="text-muted small">Self-service banking and digital support</p>
                    <a href="#" onclick="findService('digital_center')" class="btn btn-outline-primary btn-sm">
                        Find Centers
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Currency Rates Section -->
<section class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-5">
                <h2 class="fw-bold">Current Exchange Rates</h2>
                <p class="text-muted">Live rates from Central Bank of Azerbaijan</p>
            </div>
        </div>
        
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="currency-rates-card">
                    {% if currency_rates and currency_rates.rates %}
                    <div class="row g-3">
                        {% for currency, rate in currency_rates.rates.items() %}
                        {% if currency in ['USD', 'EUR', 'GBP', 'RUB', 'TRY'] %}
                        <div class="col-md-3 col-6" data-currency="{{ currency }}">
                            <div class="currency-item">
                                <div class="currency-flag">
                                    {% if currency == 'USD' %}🇺🇸
                                    {% elif currency == 'EUR' %}🇪🇺
                                    {% elif currency == 'GBP' %}🇬🇧
                                    {% elif currency == 'RUB' %}🇷🇺
                                    {% elif currency == 'TRY' %}🇹🇷
                                    {% else %}💱
                                    {% endif %}
                                </div>
                                <div>
                                    <div class="fw-bold">{{ currency }}</div>
                                    <div class="currency-rate text-primary">{{ "%.4f"|format(rate) }}</div>
                                    <small class="text-muted">AZN</small>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                        {% endfor %}
                    </div>
                    {% else %}
                    <div class="text-center py-4">
                        <div class="spinner-border text-primary mb-3"></div>
                        <p class="text-muted">Loading currency rates...</p>
                    </div>
                    {% endif %}
                    
                    <div class="text-center mt-4">
                        <a href="/currency" class="btn btn-primary">
                            View All Rates & Converter
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Quick Chat Section -->
<section class="py-5 bg-primary text-white">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h3 class="fw-bold mb-3">Need Help? Ask Our AI Assistant</h3>
                <p class="mb-4">Get instant answers about locations, currency rates, and banking services.</p>
                
                <div class="d-flex flex-wrap gap-2 mb-3">
                    <button class="btn btn-light btn-sm" onclick="sendQuickQuestion('Find nearest ATM')">
                        "Find nearest ATM"
                    </button>
                    <button class="btn btn-light btn-sm" onclick="sendQuickQuestion('What is USD rate today?')">
                        "What is USD rate today?"
                    </button>
                    <button class="btn btn-light btn-sm" onclick="sendQuickQuestion('Show me branch locations')">
                        "Show me branch locations"
                    </button>
                </div>
            </div>
            <div class="col-lg-4 text-lg-end">
                <a href="/chat" class="btn btn-light btn-lg">
                    <i class="bi bi-chat-dots me-2"></i>Start Chatting
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
function findService(serviceType) {
    // Store service type and redirect to locations page
    sessionStorage.setItem('searchServiceType', serviceType);
    window.location.href = '/locations';
}

function sendQuickQuestion(question) {
    // Store question and redirect to chat page
    sessionStorage.setItem('quickQuestion', question);
    window.location.href = '/chat';
}

// Auto-refresh currency rates every 5 minutes
setInterval(async function() {
    try {
        const response = await fetch('/api/currency/rates');
        const data = await response.json();
        if (data && data.rates) {
            CurrencyService.updateCurrencyDisplay(data.rates);
        }
    } catch (error) {
        console.log('Failed to refresh currency rates:', error);
    }
}, 300000); // 5 minutes
</script>
{% endblock %}